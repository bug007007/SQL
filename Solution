175. Combine Two Tables
SELECT firstName, lastName, city, state
FROM Person
LEFT JOIN Address USING(personId)

176. Second Highest Salary
SELECT MAX(salary) AS SecondHighestSalary
FROM Employee
WHERE salary < (
    SELECT MAX(salary)
    FROM Employee
)

177. Nth Highest Salary
CREATE FUNCTION getNthHighestSalary(N INT) RETURNS INT
BEGIN
SET N = N-1;
  RETURN (
      # Write your MySQL query statement below.
      SELECT DISTINCT salary AS getNthHighestSalary
      FROM Employee
      ORDER BY salary DESC
      LIMIT 1 OFFSET N
  );
END

178. Rank Scores
SELECT score, 
    DENSE_RANK() OVER(
        ORDER BY score DESC
        ) AS 'rank'
FROM Scores

181. Employees Earning More Than Their Managers
# Write your MySQL query statement below
SELECT a.name AS Employee
FROM Employee a
JOIN Employee b 
ON a.managerId = b.ID
WHERE a.salary > b.salary 

182. Duplicate Emails
# Write your MySQL query statement below
# SELECT Email FROM
# (
#     SELECT Email, count(Email) as num
#     from Person
#     group by Email
# ) as statistic
# WHERE num > 1

SELECT Email
FROM Person
group by Email
having count(Email) > 1

183. Customers Who Never Order
# Write your MySQL query statement below
SELECT name AS 'Customers'
FROM Customers 
WHERE id NOT IN(
    SELECT customerId FROM Orders
)

184. Department Highest Salary
# Write your MySQL query statement below
SELECT d.name AS Department,
    e.name AS Employee,
    e.Salary 
FROM Employee e
JOIN Department d
ON e.departmentId = d.id 
WHERE (e.departmentId, salary) IN
(
    SELECT departmentId, MAX(salary)
    FROM Employee 
    GROUP BY departmentId 
)
